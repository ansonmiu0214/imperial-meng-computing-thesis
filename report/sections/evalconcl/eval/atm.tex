\section{Delegated Sessions: \fancyname{ATM}}
\label{section:evalatm}

Interested readers can find the full implementation on
GitHub\footnote{\url{https://github.com/ansonmiu0214/SessionTS-Examples/ATM}}.

\begin{itemize}
\item Show that delegation is not supported
even if the protocol ``allows''
\end{itemize}

\begin{figure}[!ht]
\begin{lstlisting}[language=Scribble, tabsize=2]
module ATM;

global protocol ATM(role Bank, role Client) {
	choice at Client {
		// The string contains the client ID
		WITHDRAW(string, number) from Client to Bank;
		choice at Svr {
			BALANCE(number) from Bank to Client;		
		} or {
			FAIL(string) from Bank to Client;		
		}
		do ATM(Bank, Client);
	} or {
		DEPOSIT(string, number) from Client to Bank;
		BALANCE(number) from Bank to Client;
		do ATM(Bank, Client);
	} or {
		BYE(string) from Client to Bank;
		BYE() from Bank to Client;	
	}
}
\end{lstlisting}
\captionof{lstlisting}{The \tprotocol{ATM} Protocol}
\label{lst:atm}
\end{figure}
